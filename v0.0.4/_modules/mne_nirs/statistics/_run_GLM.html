
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mne_nirs.statistics._run_GLM &#8212; MNE-NIRS 0.0.5 documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap_divs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/gallery-rendered-html.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/bootstrap_divs.js"></script>
    <script src="../../../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../../index.html">
<p class="title">MNE-NIRS</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../auto_examples/index.html">
  Examples
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../api.html">
  API
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
        v0.0.5
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
            <a class="list-group-item list-group-item-action py-1" href=../../../../master/index.html>master</a>
            <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-nirs/v0.0.5/index.html">v0.0.5 (stable)</a>
            <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-nirs/v0.0.4/index.html">v0.0.4</a>
            <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-nirs/v0.0.3/index.html">v0.0.3</a>
            <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-nirs/v0.0.2/index.html">v0.0.2</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/mne-tools/mne-nirs" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <div class="col-12 col-md-1 col-xl-2 bd-sidebar no-sidebar"></div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-11 col-xl-8 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                

<p>
  <strong>
    <p style="border:3px; border-style:solid; border-color:#FF0000; padding: 1em;">
    
    You are reading a version (v0.0.4) of the documentation associated with a release.
    Releases provide a snapshot of the software from a specific instance in time,
    allowing you to always revert to a working version of the code.
    Releases are created at instances when the code is considered stable and feature complete.
    Whereas, the master branch contains the latest features and newest version of the code.
    To view the latest up-to-date documentation for this project,
    please have a look at <a href="../../../../master/index.html">master</a>.
    
    </p>
  </strong>
</p>


  <h1>Source code for mne_nirs.statistics._run_GLM</h1><div class="highlight"><pre>
<span></span><span class="c1"># Authors: Robert Luke &lt;mail@robertluke.net&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mne.io.pick</span> <span class="kn">import</span> <span class="n">_picks_to_idx</span>


<div class="viewcode-block" id="run_GLM"><a class="viewcode-back" href="../../../generated/mne_nirs.statistics.run_GLM.html#mne_nirs.statistics.run_GLM">[docs]</a><span class="k">def</span> <span class="nf">run_GLM</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">design_matrix</span><span class="p">,</span> <span class="n">noise_model</span><span class="o">=</span><span class="s1">&#39;ar1&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Run GLM on data using supplied design matrix.</span>

<span class="sd">    This is a wrapper function for nilearn.stats.first_level_model.run_glm.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    raw : instance of Raw</span>
<span class="sd">        The haemoglobin data.</span>
<span class="sd">    design_matrix : as specified in Nilearn</span>
<span class="sd">        The design matrix.</span>
<span class="sd">    noise_model : {&#39;ar1&#39;, &#39;ols&#39;, &#39;arN&#39;, &#39;auto&#39;}, optional</span>
<span class="sd">        The temporal variance model. Defaults to first order</span>
<span class="sd">        auto regressive model &#39;ar1&#39;.</span>
<span class="sd">        The AR model can be set to any integer value by modifying the value</span>
<span class="sd">        of N. E.g. use `ar5` for a fifth order model.</span>
<span class="sd">        If the string `auto` is provided a model with order 4 times the sample</span>
<span class="sd">        rate will be used.</span>
<span class="sd">    bins : int, optional</span>
<span class="sd">        Maximum number of discrete bins for the AR coef histogram/clustering.</span>
<span class="sd">        By default the value is 0, which will set the number of bins to the</span>
<span class="sd">        number of channels, effectively estimating the AR model for each</span>
<span class="sd">        channel.</span>
<span class="sd">    n_jobs : int, optional</span>
<span class="sd">        The number of CPUs to use to do the computation. -1 means</span>
<span class="sd">        &#39;all CPUs&#39;.</span>
<span class="sd">    verbose : int, optional</span>
<span class="sd">        The verbosity level. Default is 0.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    glm_estimates : dict</span>
<span class="sd">        Keys correspond to the different labels values values are</span>
<span class="sd">        RegressionResults instances corresponding to the voxels.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">nilearn.glm.first_level</span> <span class="kn">import</span> <span class="n">run_glm</span>

    <span class="n">picks</span> <span class="o">=</span> <span class="n">_picks_to_idx</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">,</span> <span class="s1">&#39;fnirs&#39;</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="p">[],</span> <span class="n">allow_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ch_names</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span>

    <span class="k">if</span> <span class="n">noise_model</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">noise_model</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ar</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="n">bins</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">ch_names</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">pick</span> <span class="ow">in</span> <span class="n">picks</span><span class="p">:</span>
        <span class="n">labels</span><span class="p">,</span> <span class="n">glm_estimates</span> <span class="o">=</span> <span class="n">run_glm</span><span class="p">(</span><span class="n">raw</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">pick</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                                        <span class="n">design_matrix</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                                        <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span>
                                        <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="n">ch_names</span><span class="p">[</span><span class="n">pick</span><span class="p">]]</span> <span class="o">=</span> <span class="n">glm_estimates</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="k">return</span> <span class="n">results</span></div>


<div class="viewcode-block" id="compute_contrast"><a class="viewcode-back" href="../../../generated/mne_nirs.statistics.compute_contrast.html#mne_nirs.statistics.compute_contrast">[docs]</a><span class="k">def</span> <span class="nf">compute_contrast</span><span class="p">(</span><span class="n">glm_est</span><span class="p">,</span> <span class="n">contrast</span><span class="p">,</span> <span class="n">contrast_type</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute contrasts on regression results.</span>

<span class="sd">    This is a wrapper function for nilearn.stats.contrasts.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    glm_est : dict</span>
<span class="sd">        Dictionary of nilearn regression results as returned by `run_glm`.</span>
<span class="sd">    contrast : numpy.ndarray of shape (p) or (q, p),</span>
<span class="sd">        Where q = number of contrast vectors and p = number of regressors.</span>
<span class="sd">    contrast_type : {None, ‘t’, ‘F’}, optional</span>
<span class="sd">        Type of the contrast. If None, then defaults to ‘t’ for 1D con_val</span>
<span class="sd">        and ‘F’ for 2D con_val.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    contrast : Contrast instance,</span>
<span class="sd">        Yields the statistics of the contrast (effects, variance, p-values).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">nilearn.glm.contrasts</span> <span class="kn">import</span> <span class="n">compute_contrast</span> <span class="k">as</span> <span class="n">_cc</span>
    <span class="k">return</span> <span class="n">_cc</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">glm_est</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span> <span class="n">glm_est</span><span class="p">,</span> <span class="n">contrast</span><span class="p">,</span>
               <span class="n">contrast_type</span><span class="o">=</span><span class="n">contrast_type</span><span class="p">)</span></div>
</pre></div>


              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
                        window.ga = window.ga || function () {
                            (ga.q = ga.q || []).push(arguments) };
                        ga.l = +new Date;
                        ga('create', 'UA-188272121-1', 'auto');
                        ga('set', 'anonymizeIp', true);
                        ga('send', 'pageview');
                    </script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020, Robert Luke.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.2.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>